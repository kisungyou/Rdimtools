<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Marginal Fisher Analysis — do.mfa • Rdimtools</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Marginal Fisher Analysis — do.mfa"><meta property="og:description" content="Marginal Fisher Analysis (MFA) is a supervised linear dimension reduction method.
The intrinsic graph characterizes the intraclass compactness and connects each data point with
its neighboring pionts of the same class, while the penalty graph connects the marginal points
and characterizes the interclass separability."><meta property="og:image" content="https://kisungyou.com/Rdimtools/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163713603-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163713603-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Rdimtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/quick-start.html">Quick Start with Rdimtools</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://twitter.com/kisung_you" class="external-link">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/kisungyou/Rdimtools" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="../mailto:kisungyou@outlook.com">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Marginal Fisher Analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/kisungyou/Rdimtools/blob/HEAD/R/linear_MFA.R" class="external-link"><code>R/linear_MFA.R</code></a></small>
    <div class="hidden name"><code>linear_MFA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Marginal Fisher Analysis (MFA) is a supervised linear dimension reduction method.
The intrinsic graph characterizes the intraclass compactness and connects each data point with
its neighboring pionts of the same class, while the penalty graph connects the marginal points
and characterizes the interclass separability.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">do.mfa</span><span class="op">(</span>
  <span class="va">X</span>,
  <span class="va">label</span>,
  ndim <span class="op">=</span> <span class="fl">2</span>,
  preprocess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"scale"</span>, <span class="st">"cscale"</span>, <span class="st">"decorrelate"</span>, <span class="st">"whiten"</span><span class="op">)</span>,
  k1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,
  k2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>an \((n\times p)\) matrix or data frame whose rows are observations.</p></dd>
<dt>label</dt>
<dd><p>a length-\(n\) vector of data class labels.</p></dd>
<dt>ndim</dt>
<dd><p>an integer-valued target dimension.</p></dd>
<dt>preprocess</dt>
<dd><p>an additional option for preprocessing the data.
Default is "center". See also <code><a href="aux_preprocess.html">aux.preprocess</a></code> for more details.</p></dd>
<dt>k1</dt>
<dd><p>the number of same-class neighboring points (homogeneous neighbors).</p></dd>
<dt>k2</dt>
<dd><p>the number of different-class neighboring points (heterogeneous neighbors).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a named list containing</p><dl><dt>Y</dt>
<dd><p>an \((n\times ndim)\) matrix whose rows are embedded observations.</p></dd>

<dt>trfinfo</dt>
<dd><p>a list containing information for out-of-sample prediction.</p></dd>

<dt>projection</dt>
<dd><p>a \((p\times ndim)\) whose columns are basis for projection.</p></dd>


</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Yan S, Xu D, Zhang B, Zhang H, Yang Q, Lin S (2007).
“Graph Embedding and Extensions: A General Framework for Dimensionality Reduction.”
<em>IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, <b>29</b>(1), 40--51.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Kisung You</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## generate data of 3 types with clear difference</span></span>
<span class="r-in"><span class="va">dt1</span>  <span class="op">=</span> <span class="fu"><a href="aux_gensamples.html">aux.gensamples</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">-</span><span class="fl">100</span></span>
<span class="r-in"><span class="va">dt2</span>  <span class="op">=</span> <span class="fu"><a href="aux_gensamples.html">aux.gensamples</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dt3</span>  <span class="op">=</span> <span class="fu"><a href="aux_gensamples.html">aux.gensamples</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">20</span><span class="op">)</span><span class="op">+</span><span class="fl">100</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## merge the data and create a label correspondingly</span></span>
<span class="r-in"><span class="va">X</span>      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dt1</span>,<span class="va">dt2</span>,<span class="va">dt3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">label</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## try different numbers for neighborhood size</span></span>
<span class="r-in"><span class="va">out1</span> <span class="op">=</span> <span class="fu">do.mfa</span><span class="op">(</span><span class="va">X</span>, <span class="va">label</span>, k1<span class="op">=</span><span class="fl">5</span>, k2<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">out2</span> <span class="op">=</span> <span class="fu">do.mfa</span><span class="op">(</span><span class="va">X</span>, <span class="va">label</span>, k1<span class="op">=</span><span class="fl">10</span>,k2<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span class="r-in"><span class="va">out3</span> <span class="op">=</span> <span class="fu">do.mfa</span><span class="op">(</span><span class="va">X</span>, <span class="va">label</span>, k1<span class="op">=</span><span class="fl">25</span>,k2<span class="op">=</span><span class="fl">25</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## visualize</span></span>
<span class="r-in"><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out1</span><span class="op">$</span><span class="va">Y</span>, main<span class="op">=</span><span class="st">"MFA::nbd size=5"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out2</span><span class="op">$</span><span class="va">Y</span>, main<span class="op">=</span><span class="st">"MFA::nbd size=10"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out3</span><span class="op">$</span><span class="va">Y</span>, main<span class="op">=</span><span class="st">"MFA::nbd size=25"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="linear_MFA-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Kisung You.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

